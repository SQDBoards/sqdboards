<span class="prose">
  <h3 class="flex flex-col w-fit mx-auto" id="typed-size"></h3>
</span>

<div role="radiogroup" class="hidden w-max py-3 justify-center" id="pcbChoice">
  <form
    [formGroup]="pcbFilters"
    class="flex flex-row gap-x-6 overflow-x-auto scroll-mx-2 no-scrollbar items-center justify-center"
    *isloading="availSizes.length === 0"
  >
    <div>
      <button
        class="flex w-24 max-w-[6rem] bg-transparent border-[2px] border-slate-200 p-[0.2rem]"
        id="sizeFilterDropdownToggle"
        data-dropdown="sizeFilterDropdown"
      >
        <span
          class="text-base leading-none text-center w-full font-semibold mx-0.5 pointer-events-none"
        >
          Size
          <p class="overflow-hidden text-ellipsis text-xs font-normal">
            {{
              pcbFilters.value.size
                ? pcbFilters.value.size.length === 0
                  ? "All"
                  : pcbFilters.value.size
                : "All"
            }}
          </p>
        </span>
      </button>
      <div
        id="sizeFilterDropdown"
        class="dd absolute hidden flex-col w-fit p-2 bg-white drop-shadow mt-1"
      >
        <select class="no-scrollbar p-1.5" formControlName="size" multiple>
          <option *ngFor="let size of availSizes" value="{{ size }}">
            {{ size }} sized
          </option>
        </select>
        <span class="prose prose-sm font-sans text-center select-none">
          Not sure?
          <a
            target="_blank"
            rel="noopener noreferrer"
            style="text-decoration: none"
            class="text-indigo-900"
            routerLink="/help/keyboard-size-chart"
            >Size chart.</a
          >
        </span>
      </div>
    </div>
  </form>
</div>

<div class="hidden w-full content-responsive" id="pcbsContainer">
  <div class="itemList" *isloading="loading">
    <form
      class="w-full flex flex-col gap-y-2 items-center justify-center"
      [formGroup]="pcbChoice"
      [hidden]="!pcbFilters.valid"
      (ngSubmit)="submitPcb(pcbChoice.value.pcb)"
    >
      <section class="flex flex-row flex-wrap gap-x-1 gap-y-1 justify-center">
        <div *ngFor="let pcb of showPcbs; index as i" class="item">
          <span
            class="itemGal no-scrollbar"
            #gal
            (mousedown)="this.scroll.startDragging($event, gal)"
            (mouseup)="this.scroll.stopDragging($event, gal)"
            (mousemove)="this.scroll.moveEvent($event, gal)"
          >
            <img
              *ngFor="let img of pcb.images"
              src="{{ img }}"
              alt="{{ pcb.title }} photo"
              class="snap-center pointer-events-none snap-always"
            />
          </span>
          <div class="flex flex-col">
            <p class="itemTitle">{{ pcb.title }} ({{ pcb.size }})</p>
            <ul class="flex flex-col overflow-x-scroll no-scrollbar">
              <li class="itemDesc" *ngIf="pcb.features.hotSwappable">
                Hot-swap support: yes.
              </li>
              <li class="itemDesc" *ngIf="!pcb.features.hotSwappable">
                Hot-swap support: no.
              </li>
              <li class="itemDesc">RGB: {{ pcb.features.rgb }}.</li>
              <li class="itemDesc">USB: {{ pcb.features.usbType }}.</li>
              <li class="itemDesc">Firmware: {{ pcb.features.firmware }}.</li>
            </ul>
          </div>
          <input
            class="hidden"
            type="radio"
            formControlName="pcb"
            id="pcb{{ i }}"
            [defaultChecked]="false"
            [value]="pcb"
          />
          <label
            class="w-max h-max place-self-flex-end mt-auto"
            for="pcb{{ i }}"
          >
            <squi-button
              squi-color="#ffe4e6"
              [squi-label]="
                stringify(pcb) === stringify(pcbChoice.value.pcb)
                  ? 'Picked'
                  : 'Pick'
              "
              class="place-self-flex-end"
            >
            </squi-button>
          </label>
        </div>
      </section>
      <p class="text-center">
        You picked: {{ pcbChoice.value.pcb?.title || "nothing" }}
      </p>
      <button
        class="place-self-flex-end"
        type="submit"
        [disabled]="!pcbChoice.valid"
        #subPcb
      >
        <squi-button
          squi-label="Next"
          [squi-color]="!subPcb.disabled ? '#ffe4e6' : 'transparent'"
        ></squi-button>
      </button>
    </form>
  </div>
</div>
